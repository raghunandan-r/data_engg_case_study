
2025-10-17 16:27:47,804 INFO [process_staging] --- Staging Processing Finished ---
(nelo_data_engg) ï‚© python process_staging.py
2025-10-17 17:09:31,778 INFO [process_staging] --- Starting Staging Processing ---
2025-10-17 17:09:31,790 INFO [process_staging] Processing staging file: staging/processing_batch_20251017_113440.jsonl
2025-10-17 17:09:31,803 INFO [process_staging] Parsed lines=2000, parsed_ok=2000, parse_dead=0
2025-10-17 17:09:33,585 INFO [root] Created DataFrame with 3593 rows from 2000 events
2025-10-17 17:09:33,730 INFO [process_staging] Validation result: good_rows=3593, bad_rows=0
2025-10-17 17:09:33,796 INFO [process_staging] Bulk insert succeeded: rows=3593
2025-10-17 17:09:33,797 INFO [process_staging] File done: staging/processing_batch_20251017_113440.jsonl lines=2000 parsed_ok=2000 flattened=3593 inserted=3593 duration_s=2.01
2025-10-17 17:09:33,798 INFO [process_staging] Running silver transforms...
2025-10-17 17:09:33,800 INFO [process_staging] Upserting into dim_users...
2025-10-17 17:09:33,817 INFO [process_staging] Successfully upserted into dim_users.
2025-10-17 17:09:33,817 INFO [process_staging] Upserting into dim_products...
2025-10-17 17:09:33,840 INFO [process_staging] Successfully upserted into dim_products.
2025-10-17 17:09:33,840 INFO [process_staging] Upserting into dim_item_lists...
2025-10-17 17:09:33,881 INFO [process_staging] Successfully upserted into dim_item_lists.
2025-10-17 17:09:33,881 INFO [process_staging] Processing dim_campaigns...
2025-10-17 17:09:33,898 INFO [process_staging] Successfully upserted into dim_campaigns.
2025-10-17 17:09:33,898 INFO [process_staging] Processing dim_experiments...
2025-10-17 17:09:33,913 INFO [process_staging] Successfully upserted into dim_experiments.
2025-10-17 17:09:33,914 INFO [process_staging] Loading fct_events...
2025-10-17 17:09:33,946 INFO [process_staging] Successfully loaded into fct_events.
2025-10-17 17:09:33,946 INFO [process_staging] Marking staged events as processed...
2025-10-17 17:09:33,960 INFO [process_staging] Successfully marked staged events as processed.
2025-10-17 17:09:33,960 INFO [process_staging] Silver transforms executed successfully.
2025-10-17 17:09:34,018 INFO [process_staging] Transaction committed successfully.
2025-10-17 17:09:34,018 INFO [process_staging] Moved staging/processing_batch_20251017_113440.jsonl to processed/processing_batch_20251017_113440.jsonl
2025-10-17 17:09:34,018 INFO [process_staging] Processing staging file: staging/processing_batch_20251017_011145.jsonl
2025-10-17 17:09:34,028 INFO [process_staging] Parsed lines=2000, parsed_ok=2000, parse_dead=0
2025-10-17 17:09:35,716 INFO [root] Created DataFrame with 3398 rows from 2000 events
2025-10-17 17:09:35,855 INFO [process_staging] Validation result: good_rows=3398, bad_rows=0
2025-10-17 17:09:35,919 INFO [process_staging] Bulk insert succeeded: rows=3398
2025-10-17 17:09:35,919 INFO [process_staging] File done: staging/processing_batch_20251017_011145.jsonl lines=2000 parsed_ok=2000 flattened=3398 inserted=3398 duration_s=1.90
2025-10-17 17:09:35,920 INFO [process_staging] Running silver transforms...
2025-10-17 17:09:35,922 INFO [process_staging] Upserting into dim_users...
2025-10-17 17:09:35,938 INFO [process_staging] Successfully upserted into dim_users.
2025-10-17 17:09:35,938 INFO [process_staging] Upserting into dim_products...
2025-10-17 17:09:35,966 INFO [process_staging] Successfully upserted into dim_products.
2025-10-17 17:09:35,966 INFO [process_staging] Upserting into dim_item_lists...
2025-10-17 17:09:36,002 INFO [process_staging] Successfully upserted into dim_item_lists.
2025-10-17 17:09:36,003 INFO [process_staging] Processing dim_campaigns...
2025-10-17 17:09:36,022 INFO [process_staging] Successfully upserted into dim_campaigns.
2025-10-17 17:09:36,022 INFO [process_staging] Processing dim_experiments...
2025-10-17 17:09:36,039 INFO [process_staging] Successfully upserted into dim_experiments.
2025-10-17 17:09:36,040 INFO [process_staging] Loading fct_events...
2025-10-17 17:09:36,091 INFO [process_staging] Successfully loaded into fct_events.
2025-10-17 17:09:36,092 INFO [process_staging] Marking staged events as processed...
2025-10-17 17:09:36,109 INFO [process_staging] Successfully marked staged events as processed.
2025-10-17 17:09:36,110 INFO [process_staging] Silver transforms executed successfully.
2025-10-17 17:09:36,257 INFO [process_staging] Transaction committed successfully.
2025-10-17 17:09:36,257 INFO [process_staging] Moved staging/processing_batch_20251017_011145.jsonl to processed/processing_batch_20251017_011145.jsonl
2025-10-17 17:09:36,257 INFO [process_staging] Processing staging file: staging/processing_batch_20251017_011319.jsonl
2025-10-17 17:09:36,267 INFO [process_staging] Parsed lines=2000, parsed_ok=2000, parse_dead=0
2025-10-17 17:09:37,969 INFO [root] Created DataFrame with 3332 rows from 2000 events
2025-10-17 17:09:38,091 INFO [process_staging] Validation result: good_rows=3332, bad_rows=0
2025-10-17 17:09:38,125 INFO [process_staging] Bulk insert succeeded: rows=3332
2025-10-17 17:09:38,125 INFO [process_staging] File done: staging/processing_batch_20251017_011319.jsonl lines=2000 parsed_ok=2000 flattened=3332 inserted=3332 duration_s=1.87
2025-10-17 17:09:38,126 INFO [process_staging] Running silver transforms...
2025-10-17 17:09:38,128 INFO [process_staging] Upserting into dim_users...
2025-10-17 17:09:38,142 INFO [process_staging] Successfully upserted into dim_users.
2025-10-17 17:09:38,142 INFO [process_staging] Upserting into dim_products...
2025-10-17 17:09:38,165 INFO [process_staging] Successfully upserted into dim_products.
2025-10-17 17:09:38,165 INFO [process_staging] Upserting into dim_item_lists...
2025-10-17 17:09:38,197 INFO [process_staging] Successfully upserted into dim_item_lists.
2025-10-17 17:09:38,198 INFO [process_staging] Processing dim_campaigns...
2025-10-17 17:09:38,214 INFO [process_staging] Successfully upserted into dim_campaigns.
2025-10-17 17:09:38,214 INFO [process_staging] Processing dim_experiments...
2025-10-17 17:09:38,227 INFO [process_staging] Successfully upserted into dim_experiments.
2025-10-17 17:09:38,228 INFO [process_staging] Loading fct_events...
2025-10-17 17:09:38,271 INFO [process_staging] Successfully loaded into fct_events.
2025-10-17 17:09:38,272 INFO [process_staging] Marking staged events as processed...
2025-10-17 17:09:38,281 INFO [process_staging] Successfully marked staged events as processed.
2025-10-17 17:09:38,281 INFO [process_staging] Silver transforms executed successfully.
2025-10-17 17:09:38,351 INFO [process_staging] Transaction committed successfully.
2025-10-17 17:09:38,352 INFO [process_staging] Moved staging/processing_batch_20251017_011319.jsonl to processed/processing_batch_20251017_011319.jsonl
2025-10-17 17:09:38,352 INFO [process_staging] Processing staging file: staging/processing_batch_20251017_155739.jsonl
2025-10-17 17:09:38,362 INFO [process_staging] Parsed lines=2000, parsed_ok=2000, parse_dead=0
2025-10-17 17:09:40,107 INFO [root] Created DataFrame with 3394 rows from 2000 events
2025-10-17 17:09:40,250 INFO [process_staging] Validation result: good_rows=3394, bad_rows=0
2025-10-17 17:09:40,283 INFO [process_staging] Bulk insert succeeded: rows=3394
2025-10-17 17:09:40,283 INFO [process_staging] File done: staging/processing_batch_20251017_155739.jsonl lines=2000 parsed_ok=2000 flattened=3394 inserted=3394 duration_s=1.93
2025-10-17 17:09:40,284 INFO [process_staging] Running silver transforms...
2025-10-17 17:09:40,286 INFO [process_staging] Upserting into dim_users...
2025-10-17 17:09:40,301 INFO [process_staging] Successfully upserted into dim_users.
2025-10-17 17:09:40,301 INFO [process_staging] Upserting into dim_products...
2025-10-17 17:09:40,325 INFO [process_staging] Successfully upserted into dim_products.
2025-10-17 17:09:40,325 INFO [process_staging] Upserting into dim_item_lists...
2025-10-17 17:09:40,356 INFO [process_staging] Successfully upserted into dim_item_lists.
2025-10-17 17:09:40,356 INFO [process_staging] Processing dim_campaigns...
2025-10-17 17:09:40,372 INFO [process_staging] Successfully upserted into dim_campaigns.
2025-10-17 17:09:40,372 INFO [process_staging] Processing dim_experiments...
2025-10-17 17:09:40,386 INFO [process_staging] Successfully upserted into dim_experiments.
2025-10-17 17:09:40,386 INFO [process_staging] Loading fct_events...
2025-10-17 17:09:40,430 INFO [process_staging] Successfully loaded into fct_events.
2025-10-17 17:09:40,430 INFO [process_staging] Marking staged events as processed...
2025-10-17 17:09:40,439 INFO [process_staging] Successfully marked staged events as processed.
2025-10-17 17:09:40,440 INFO [process_staging] Silver transforms executed successfully.
2025-10-17 17:09:40,653 INFO [process_staging] Transaction committed successfully.
2025-10-17 17:09:40,653 INFO [process_staging] Moved staging/processing_batch_20251017_155739.jsonl to processed/processing_batch_20251017_155739.jsonl
2025-10-17 17:09:40,654 INFO [process_staging] Processing staging file: staging/processing_batch_20251017_154704.jsonl
2025-10-17 17:09:40,664 INFO [process_staging] Parsed lines=2000, parsed_ok=2000, parse_dead=0
2025-10-17 17:09:42,341 INFO [root] Created DataFrame with 3407 rows from 2000 events
2025-10-17 17:09:42,476 INFO [process_staging] Validation result: good_rows=3407, bad_rows=0
2025-10-17 17:09:42,512 INFO [process_staging] Bulk insert succeeded: rows=3407
2025-10-17 17:09:42,512 INFO [process_staging] File done: staging/processing_batch_20251017_154704.jsonl lines=2000 parsed_ok=2000 flattened=3407 inserted=3407 duration_s=1.86
2025-10-17 17:09:42,513 INFO [process_staging] Running silver transforms...
2025-10-17 17:09:42,514 INFO [process_staging] Upserting into dim_users...
2025-10-17 17:09:42,528 INFO [process_staging] Successfully upserted into dim_users.
2025-10-17 17:09:42,528 INFO [process_staging] Upserting into dim_products...
2025-10-17 17:09:42,545 INFO [process_staging] Successfully upserted into dim_products.
2025-10-17 17:09:42,545 INFO [process_staging] Upserting into dim_item_lists...
2025-10-17 17:09:42,575 INFO [process_staging] Successfully upserted into dim_item_lists.
2025-10-17 17:09:42,575 INFO [process_staging] Processing dim_campaigns...
2025-10-17 17:09:42,591 INFO [process_staging] Successfully upserted into dim_campaigns.
2025-10-17 17:09:42,591 INFO [process_staging] Processing dim_experiments...
2025-10-17 17:09:42,604 INFO [process_staging] Successfully upserted into dim_experiments.
2025-10-17 17:09:42,604 INFO [process_staging] Loading fct_events...
2025-10-17 17:09:42,628 INFO [process_staging] Successfully loaded into fct_events.
2025-10-17 17:09:42,628 INFO [process_staging] Marking staged events as processed...
2025-10-17 17:09:42,640 INFO [process_staging] Successfully marked staged events as processed.
2025-10-17 17:09:42,640 INFO [process_staging] Silver transforms executed successfully.
2025-10-17 17:09:42,702 INFO [process_staging] Transaction committed successfully.
2025-10-17 17:09:42,703 INFO [process_staging] Moved staging/processing_batch_20251017_154704.jsonl to processed/processing_batch_20251017_154704.jsonl
2025-10-17 17:09:42,939 INFO [process_staging] --- Staging Processing Finished ---
